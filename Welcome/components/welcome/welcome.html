<div class="welcome">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="welcome-header-icon">
                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                        viewBox="0 0 60 60" style="enable-background:new 0 0 60 60;" width="30" height="30" xml:space="preserve">
                    <g>
                        <path style="fill:#F0C419;" d="M30,0c-0.552,0-1,0.448-1,1v6c0,0.552,0.448,1,1,1s1-0.448,1-1V1C31,0.448,30.552,0,30,0z"/>
                        <path style="fill:#F0C419;" d="M30,52c-0.552,0-1,0.448-1,1v6c0,0.552,0.448,1,1,1s1-0.448,1-1v-6C31,52.448,30.552,52,30,52z"/>
                        <path style="fill:#F0C419;" d="M59,29h-6c-0.552,0-1,0.448-1,1s0.448,1,1,1h6c0.552,0,1-0.448,1-1S59.552,29,59,29z"/>
                        <path style="fill:#F0C419;" d="M8,30c0-0.552-0.448-1-1-1H1c-0.552,0-1,0.448-1,1s0.448,1,1,1h6C7.552,31,8,30.552,8,30z"/>
                        <path style="fill:#F0C419;" d="M46.264,14.736c0.256,0,0.512-0.098,0.707-0.293l5.736-5.736c0.391-0.391,0.391-1.023,0-1.414
                            s-1.023-0.391-1.414,0l-5.736,5.736c-0.391,0.391-0.391,1.023,0,1.414C45.752,14.639,46.008,14.736,46.264,14.736z"/>
                        <path style="fill:#F0C419;" d="M13.029,45.557l-5.736,5.736c-0.391,0.391-0.391,1.023,0,1.414C7.488,52.902,7.744,53,8,53
                            s0.512-0.098,0.707-0.293l5.736-5.736c0.391-0.391,0.391-1.023,0-1.414S13.42,45.166,13.029,45.557z"/>
                        <path style="fill:#F0C419;" d="M46.971,45.557c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414l5.736,5.736
                            C51.488,52.902,51.744,53,52,53s0.512-0.098,0.707-0.293c0.391-0.391,0.391-1.023,0-1.414L46.971,45.557z"/>
                        <path style="fill:#F0C419;" d="M8.707,7.293c-0.391-0.391-1.023-0.391-1.414,0s-0.391,1.023,0,1.414l5.736,5.736
                            c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293c0.391-0.391,0.391-1.023,0-1.414L8.707,7.293z"/>
                        <path style="fill:#F0C419;" d="M50.251,21.404c0.162,0.381,0.532,0.61,0.921,0.61c0.13,0,0.263-0.026,0.39-0.08l2.762-1.172
                            c0.508-0.216,0.746-0.803,0.53-1.311s-0.804-0.746-1.311-0.53l-2.762,1.172C50.272,20.309,50.035,20.896,50.251,21.404z"/>
                        <path style="fill:#F0C419;" d="M9.749,38.596c-0.216-0.508-0.803-0.746-1.311-0.53l-2.762,1.172
                            c-0.508,0.216-0.746,0.803-0.53,1.311c0.162,0.381,0.532,0.61,0.921,0.61c0.13,0,0.263-0.026,0.39-0.08l2.762-1.172
                            C9.728,39.691,9.965,39.104,9.749,38.596z"/>
                        <path style="fill:#F0C419;" d="M54.481,38.813L51.7,37.688c-0.511-0.207-1.095,0.041-1.302,0.553
                            c-0.207,0.512,0.041,1.095,0.553,1.302l2.782,1.124c0.123,0.049,0.25,0.073,0.374,0.073c0.396,0,0.771-0.236,0.928-0.626
                            C55.241,39.603,54.994,39.02,54.481,38.813z"/>
                        <path style="fill:#F0C419;" d="M5.519,21.188L8.3,22.312c0.123,0.049,0.25,0.073,0.374,0.073c0.396,0,0.771-0.236,0.928-0.626
                            c0.207-0.512-0.041-1.095-0.553-1.302l-2.782-1.124c-0.513-0.207-1.095,0.04-1.302,0.553C4.759,20.397,5.006,20.98,5.519,21.188z"
                            />
                        <path style="fill:#F0C419;" d="M39.907,50.781c-0.216-0.508-0.803-0.745-1.311-0.53c-0.508,0.216-0.746,0.803-0.53,1.311
                            l1.172,2.762c0.162,0.381,0.532,0.61,0.921,0.61c0.13,0,0.263-0.026,0.39-0.08c0.508-0.216,0.746-0.803,0.53-1.311L39.907,50.781z"
                            />
                        <path style="fill:#F0C419;" d="M21.014,9.829c0.13,0,0.263-0.026,0.39-0.08c0.508-0.216,0.746-0.803,0.53-1.311l-1.172-2.762
                            c-0.215-0.509-0.802-0.747-1.311-0.53c-0.508,0.216-0.746,0.803-0.53,1.311l1.172,2.762C20.254,9.6,20.625,9.829,21.014,9.829z"/>
                        <path style="fill:#F0C419;" d="M21.759,50.398c-0.511-0.205-1.095,0.04-1.302,0.553l-1.124,2.782
                            c-0.207,0.512,0.041,1.095,0.553,1.302c0.123,0.049,0.25,0.073,0.374,0.073c0.396,0,0.771-0.236,0.928-0.626l1.124-2.782
                            C22.519,51.188,22.271,50.605,21.759,50.398z"/>
                        <path style="fill:#F0C419;" d="M38.615,9.675c0.396,0,0.771-0.236,0.928-0.626l1.124-2.782c0.207-0.512-0.041-1.095-0.553-1.302
                            c-0.511-0.207-1.095,0.041-1.302,0.553L37.688,8.3c-0.207,0.512,0.041,1.095,0.553,1.302C38.364,9.651,38.491,9.675,38.615,9.675z"
                            />
                    </g>
                    <circle style="fill:#F0C419;" cx="30" cy="30" r="20"/>
                    <circle style="fill:#F0C419;" cx="30" cy="30" r="15"/>
                   </svg>
                </div>
                <div class="welcome-header">Welcome, {{ctrl.userInfo.fullName}}</div>
            </div>
        </div>
        <br/>
        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-6">
                <div class="profile-header-container user-info">   
                    <div class="section-title">
                        User Profile
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-4 text-center">
                        <div class="profile-header-container avatar">   
                            <div class="profile-header-img text-center">
                                <img class="img-circle user-icon" ng-src="{{ctrl.userInfo.avatar.Url}}" />
                                <i class="glyphicon glyphicon-pencil" ng-click="ctrl.openPropModal()"></i>
                                <!-- <span class="rank-label-container">
                                    <div class="full-name-info">{{ctrl.userInfo.avatarItem.Title}}</div>
                                </span> -->
                            </div>
                        </div>
                        <h4>Avatar</h4>
                        <a ng-if="ctrl.userInfo.userRole == 'Manager'" class="btn btn-success" href="https://thebank.info53.com/teams/HCInt/Learn/Gamification/SiteAssets/app/Manager.aspx">Manager Page</a>
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-8">
                        <div class="profile-header-img text-center">
                            <!-- <img class="img-circle user-icon" ng-src="/_layouts/15/userphoto.aspx?size=L&username={{ctrl.userInfo.userName}}" /> -->
                            <div class="img-circle user-icon" style="background-image: url('/_layouts/15/userphoto.aspx?size=L&username={{ctrl.userInfo.userName}}')"></div>
                            <span class="rank-label-container">
                                <div class="credits-info">{{ctrl.userInfo.xp}} XP</div>
                                <div class="full-name-info">{{ctrl.userInfo.fullName}}</div>
                                <span class="position-info">{{ctrl.userInfo.position}}</span>
                                <span ng-if="ctrl.userInfo.position && ctrl.userInfo.department">&nbsp;|&nbsp;</span>
                                <span class="department-info">{{ctrl.userInfo.department}}</span>
                            </span>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <br/>
                </div>
            </div>
            <div class="col-sm-12 col-md-12 col-lg-6 text-center">
                <div class="recent-activity">
                    <div class="section-title">
                        Recent Activity
                    </div>
                    <div ng-repeat="item in ctrl.recentTasks track by $index" class="col-sm-12 col-md-12 col-lg-12">
                        <div ng-if="item['odata.type'] == 'SP.Data.BadgesTaskLogListItem'" class="recent-container">
                            <div class="user-image">
                                <img class="img-circle" ng-src="{{item.AvatarItem.Url}}" />
                                <div>&nbsp;{{item.AssignedTo.Title}}</div>
                            </div>
                            <div>
                                <div>{{item.Badge.Title}}: {{item.Title}}</div>
                                <div>{{ctrl.moment(item.Created).format('MM/DD/YYYY h:mm a')}}</div>
                            </div>
                        </div>
                        <div ng-if="item['odata.type'] == 'SP.Data.BadgesListListItem' || item['odata.type'] == 'SP.Data.BadgesListItem'" class="recent-container">
                            <div class="user-image">
                                <img class="img-circle" ng-src="{{item.AvatarItem.Url}}" />
                                <div>&nbsp;{{item.TaskLog.AssignedTo.Title}}</div>
                            </div>
                            <div>
                                <img class="img-circle recent-badge-icon" ng-src="{{item.Icon.Url}}" />
                                <div>
                                    <div>{{item.Title}}</div>
                                    <div>
                                        <div ng-if="item.BadgeType == 'Manager'">
                                            Awarded by {{item.TaskLog.Author.Title}}
                                        </div>
                                        <div>
                                            {{ctrl.moment(item.TaskLog.Created).format('MM/DD/YYYY h:mm a')}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <br/>
        <div class="row">
            <div class="col-sm-12">
                <h4 class="task-map-header">Tasks Map</h4>
                <div>Gain badges by completing your tasks</div>
            </div>
        </div>
        <br/>
        <div class="row">
            <div class="col-sm-12 text-center">
                <div class="tasks-map">
                    <div class="map-item-start">
                        <div>START</div>
                    </div>
                    <div ng-repeat="row in ctrl.groupedTasks track by $index"
                        ng-init="parentIdx = $index"
                        class="tasks-map-row" 
                        ng-class="{'reverse': $index%2!=0,
                                    'first-map-row': $index==0
                                }"
                    >
                        <div class="map-item text-center bg-color-{{$index}}"
                            ng-if="!item.isEmpty" 
                            ng-repeat="item in row track by $index"
                            ng-click="ctrl.generatePdf($event, item);"
                            ng-style="{'background-color': ctrl.colorArr[$index]}"
                            ng-init="isHover = false"
                            ng-mouseenter="isHover = true"
                            ng-mouseleave="isHover = false"
                            ng-class="{
                                'not-completed': (!isHover && !ctrl.checkTask(item.Title, item.BadgeId)),
                                'first-map-item': (parentIdx==0 && $index==0),
                                'end-bottom': (parentIdx%2==0 && $index==4),
                                'end-top': (parentIdx%2!=0 && $index==0),
                                'start-bottom': ((parentIdx%2!=0 && $index==4)),
                                'start-top': (parentIdx!=0 && parentIdx%2==0 && $index==0),
                                'last-map-item': (parentIdx==ctrl.groupedTasks.length-1 && $index==row.length-1),
                                'disabled-task': !ctrl.checkIsAllowedTask(item.BadgeId)
                            }"
                        >
                            <!-- <span class="glyphicon glyphicon-star" 
                                ng-if="ctrl.checkTask(item.Title, item.BadgeId)">
                            </span> -->
                            <img 
                                class="avatar-image" 
                                ng-src="{{ctrl.userInfo.avatar.Url}}"
                                ng-if="ctrl.checkTask(item.Title, item.BadgeId) && ctrl.getLastCompletedTask() == item.Id"
                            >
                            <div class="snackbar">{{item.Badge.Title}}: {{item.Title}}</div>
                        </div>
                        <div class="map-item text-center empty-map-item"
                            ng-repeat="item in row track by $index"
                            ng-class="{
                                'not-completed': (!isHover && !ctrl.checkTask(item.Title, item.BadgeId)),
                                'first-map-item': (parentIdx==0 && $index==0),
                                'end-bottom': (parentIdx%2==0 && $index==4),
                                'end-top': (parentIdx%2!=0 && $index==0),
                                'start-bottom': ((parentIdx%2!=0 && $index==4)),
                                'start-top': (parentIdx!=0 && parentIdx%2==0 && $index==0),
                                'last-map-item': (parentIdx==ctrl.groupedTasks.length-1 && $index==row.length-1)
                            }"
                            ng-if="item.isEmpty">
                        </div>
                    </div>
                    <div class="map-item-finish">
                        <div>FINISH</div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-sm-12 col-md-12 col-lg-6 text-center">
                <a ng-if="ctrl.userInfo.userRole == 'Manager'" class="btn btn-success" href="https://thebank.info53.com/teams/HCInt/Learn/Gamification/SiteAssets/app/Manager.aspx">Manager Page</a>
            </div> -->
            <div class="clearfix"></div>
        </div>
    </div>
</div>
